<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="" />
    <link
      rel="stylesheet"
      as="style"
      onload="this.rel='stylesheet'"
      href="https://fonts.googleapis.com/css2?display=swap&amp;family=Manrope%3Awght%40400%3B500%3B700%3B800&amp;family=Noto+Sans%3Awght%40400%3B500%3B700%3B900"
    />

    <title>result</title>
    <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64," />
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <!-- Naver Maps JS + Geocoder submodule -->
    <script src="https://oapi.map.naver.com/openapi/v3/maps.js?ncpClientId=XVuSwfoOb_1PXLpsmjH2&submodules=geocoder"></script>

</head>
<body>
    <div class="relative flex size-full min-h-screen flex-col bg-white group/design-root overflow-x-hidden" style='font-family: Manrope, "Noto Sans", sans-serif;'>
      <div class="layout-container flex h-full grow flex-col">
        <header class="flex items-center justify-between whitespace-nowrap border-b border-solid border-b-[#f0f2f5] px-10 py-3">
          <div class="flex items-center gap-4 text-[#111418]">
            <div class="size-4">
              <svg viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
                <g clip-path="url(#clip0_6_330)">
                  <path
                    fill-rule="evenodd"
                    clip-rule="evenodd"
                    d="M24 0.757355L47.2426 24L24 47.2426L0.757355 24L24 0.757355ZM21 35.7574V12.2426L9.24264 24L21 35.7574Z"
                    fill="currentColor"
                  ></path>
                </g>
                <defs>
                  <clipPath id="clip0_6_330"><rect width="48" height="48" fill="white"></rect></clipPath>
                </defs>
              </svg>
            </div>
            <h2 class="text-[#111418] text-lg font-bold leading-tight tracking-[-0.015em]">Drawmind</h2>
          </div>
          <div class="flex flex-1 justify-end gap-8">
            <div class="flex items-center gap-9">
              <a class="text-[#111418] text-sm font-medium leading-normal" href="#">Home</a>
              <a class="text-[#111418] text-sm font-medium leading-normal" href="#">About</a>
          <!--<a class="text-[#111418] text-sm font-medium leading-normal" href="#">Services</a>
             <a class="text-[#111418] text-sm font-medium leading-normal" href="#">Contact</a> --> 
            </div>
          </div>
        </header>
                <div class="px-40 flex flex-1 justify-center py-5">
          <div class="layout-content-container flex flex-col max-w-[960px] flex-1">

            <div class="flex flex-col gap-4 px-4 py-6">
              <h2 class="text-[#111418] tracking-light text-[28px] font-bold leading-tight text-center pb-3 pt-5">ì¸¡ì • ê²°ê³¼</h2>
              <div class="flex flex-wrap gap-4">
                <div class="flex min-w-72 flex-1 flex-col gap-2 rounded-xl border border-[#dbe0e6] p-6">
                  <p class="text-[#111418] text-base font-medium leading-normal">ì¸ì§€ ì˜ì—­</p>
                  <p class="text-[#111418] tracking-light text-[32px] font-bold leading-tight truncate">í‰ê·  ì ìˆ˜</p>
                  <div class="grid min-h-[180px] grid-flow-col gap-6 grid-rows-[1fr_auto] items-end justify-items-center px-3">
                    <div class="border-[#60758a] bg-[#f0f2f5] border-t-2 w-full" style="height: 30%;"></div>
                    <p class="text-[#60758a] text-[13px] font-bold leading-normal tracking-[0.015em]">ê¸°ì–µë ¥</p>
                    <div class="border-[#60758a] bg-[#f0f2f5] border-t-2 w-full" style="height: 30%;"></div>
                    <p class="text-[#60758a] text-[13px] font-bold leading-normal tracking-[0.015em]">ì§€ë‚¨ë ¥</p>
                    <div class="border-[#60758a] bg-[#f0f2f5] border-t-2 w-full" style="height: 90%;"></div>
                    <p class="text-[#60758a] text-[13px] font-bold leading-normal tracking-[0.015em]">ì–¸ì–´ì˜ì—­</p>
                    <div class="border-[#60758a] bg-[#f0f2f5] border-t-2 w-full" style="height: 70%;"></div>
                    <p class="text-[#60758a] text-[13px] font-bold leading-normal tracking-[0.015em]">íŒë‹¨ë ¥</p>
                    <div class="border-[#60758a] bg-[#f0f2f5] border-t-2 w-full" style="height: 100%;"></div>
                    <p class="text-[#60758a] text-[13px] font-bold leading-normal tracking-[0.015em]">ì‹œê³µê°„ëŠ¥ë ¥</p>
                  </div>
                </div>
              </div>
              <p class="text-[#111418] text-lg font-normal leading-normal pb-3 pt-1 px-4 text-center">
                ì¸ì§€ í‰ê°€ ê²°ê³¼ì— ë”°ë¥´ë©´, <strong>ê¸°ì–µë ¥</strong>ê³¼ <strong>ì§€ë‚¨ë ¥</strong> ì˜ì—­ì—ì„œ ì•½ê°„ì˜ ì–´ë ¤ì›€ì´ ê°ì§€ë˜ì—ˆìŠµë‹ˆë‹¤. <br>
                ì¸ì§€ ê±´ê°•ì„ ìœ ì§€í•˜ê¸° ìœ„í•´ ì´ ë¶€ë¶„ë“¤ì„ ì¼ì°ë¶€í„° ê´€ë¦¬í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤.
              </p>
            </div>

            <div class="flex flex-col gap-4 px-4 py-6">
              <h2 class="text-[#111418] text-[22px] font-bold leading-tight tracking-[-0.015em] px-4 pb-3 pt-5">ë‹¤ìŒ ë‹¨ê³„</h2>
              <div class="border border-[#dbe0e6] rounded-xl p-6">
                <p class="text-[#111418] text-lg font-normal leading-normal text-center">
                  ì¸ì§€ ê±´ê°•ì€ ìš°ë¦¬ ëª¸ì²˜ëŸ¼ ê¾¸ì¤€í•œ ê´€ë¦¬ê°€ í•„ìš”í•´ìš”. <br>
                  ì „ë¬¸ê°€ì˜ ë„ì›€ì„ ë°›ëŠ” ê²ƒì´ ê°€ì¥ í™•ì‹¤í•˜ê³  ì•ˆì „í•œ ë°©ë²•ì…ë‹ˆë‹¤. <br><br>
                  <strong>ì˜ë£Œ ì „ë¬¸ê°€ì™€ ìƒë‹´</strong>: ê°€ê¹Œìš´ ë³‘ì›ì´ë‚˜ ë³´ê±´ì†Œì—ì„œ ì „ë¬¸ì˜ì™€ ìƒë‹´í•´ë³´ì„¸ìš”. <br>
                  <strong>ì¡°ê¸° ë°œê²¬ì˜ ì¤‘ìš”ì„±</strong>: ì¼ì°ë¶€í„° ê´€ë¦¬í•˜ë©´ ì¸ì§€ ëŠ¥ë ¥ì„ ê±´ê°•í•˜ê²Œ ìœ ì§€í•˜ëŠ” ë° í° ë„ì›€ì´ ë©ë‹ˆë‹¤.
                </p>
              </div>
            </div>

            <div class="flex flex-col gap-4 px-4 py-6">
              <h2 class="text-[#111418] text-[22px] font-bold leading-tight tracking-[-0.015em] px-4 pb-3 pt-5">ì¼ìƒìƒí™œì—ì„œ ì‹¤ì²œí•  ìˆ˜ ìˆëŠ” ë°©ë²•ë“¤</h2>
              <div class="border border-[#dbe0e6] rounded-xl p-6">
                <ul class="list-none p-0 m-0">
                  <li class="text-[#111418] text-lg font-normal leading-normal mb-4">
                    <strong>ğŸ§  ì¸ì§€ í›ˆë ¨ í”„ë¡œê·¸ë¨</strong>: ê¸°ì–µë ¥ì„ ì¦ì§„ì‹œí‚¤ëŠ” í›ˆë ¨ í”„ë¡œê·¸ë¨ì— ì°¸ì—¬í•´ ë³´ì„¸ìš”.
                  </li>
                  <li class="text-[#111418] text-lg font-normal leading-normal mb-4">
                    <strong>ğŸ¨ ìƒˆë¡œìš´ ì·¨ë¯¸ ìƒí™œ</strong>: ê·¸ë¦¼ ê·¸ë¦¬ê¸°, ì•…ê¸° ë°°ìš°ê¸° ë“± ë¨¸ë¦¬ë¥¼ ìê·¹í•˜ëŠ” í™œë™ì„ ì‹œì‘í•´ ë³´ì„¸ìš”.
                  </li>
                  <li class="text-[#111418] text-lg font-normal leading-normal mb-4">
                    <strong>ğŸƒâ€â™‚ï¸ ê·œì¹™ì ì¸ ìƒí™œ ìŠµê´€</strong>: ê· í˜• ì¡íŒ ì‹ì‚¬ë¥¼ í•˜ê³ , ê¾¸ì¤€íˆ ê±·ê¸° ìš´ë™ì„ í•´ë³´ì„¸ìš”.
                  </li>
                  <li class="text-[#111418] text-lg font-normal leading-normal">
                    <strong>ğŸ—£ï¸ ì‚¬íšŒ í™œë™ ì°¸ì—¬</strong>: ì¹œêµ¬ë¶„ë“¤ê³¼ ë§Œë‚˜ ëŒ€í™”í•˜ê±°ë‚˜, ë™í˜¸íšŒ í™œë™ì— ì°¸ì—¬í•´ ë³´ì„¸ìš”.
                  </li>
                </ul>
              </div>
            </div>


            <h2 class="text-[#111418] text-[22px] font-bold leading-tight tracking-[-0.015em] px-4 pb-3 pt-5">
             ì£¼ë³€ ì§€ì› ì„¼í„°
            </h2>

<!-- ìƒíƒœ í‘œì‹œ ì˜ì—­ -->
            <div id="status" class="mx-4 mb-3 p-3 rounded-lg bg-blue-50 border border-blue-200">
              <p class="text-sm text-blue-700">ì§€ë„ë¥¼ ë¡œë”© ì¤‘ì…ë‹ˆë‹¤...</p>
            </div>

            <div id="map" class="mx-4 rounded-xl border border-[#dbe0e6]" style="height: 420px;"></div>

            <div id="center-list" class="px-4 py-3 grid gap-3"></div>

            <div class="flex px-4 py-3">
              <div
                class="w-full bg-center bg-no-repeat aspect-video bg-cover rounded-xl object-cover"
                style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuDzH3wSNKos48dF4gJKVP_tdol_zkb6KCtAKgmIeecUvK-aUe9Pq5a45bTJomNi--soSDjN7D-VDMyI_YrqAUMmvuuOvD0ppbwROqm9OkOp2ZEmJNF73indqoIwB6CCEgoeV3-k4KLOLzOIMcQBSAFMySbiRT8m8KrgnMsrMVbp_n3lkLrglOWTwmIO3POUat8k4wv77hIAz-OaWod1rYU9pF2QzMwPTfmM8373ayAcmEV84_1DbmOXcR4T0XU02P280qE-dyq_rw");'
              ></div>
            </div>

            <p class="text-[#111418] text-base font-normal leading-normal pb-3 pt-1 px-4 text-center">
              ê°€ê¹Œìš´ ì§€ì› ì„¼í„°ë¥¼ ì°¾ì•„ ì¸ì§€ ê±´ê°•ì— ë§ëŠ” ìë£Œì™€ í”„ë¡œê·¸ë¨ì„ ì œê³µë°›ìœ¼ì„¸ìš”. ì´ëŸ° ì„¼í„°ë“¤ì€ ì¸ì§€ ë³€í™” ê´€ë¦¬ì— ì†Œì¤‘í•œ ë„ì›€ê³¼ ì•ˆë‚´ë¥¼ ì œê³µí•©ë‹ˆë‹¤.
            </p>

            <h2 class="text-[#111418] text-[22px] font-bold leading-tight tracking-[-0.015em] px-4 pb-3 pt-5">ì¡°ê¸° ê°œì…ì˜ ì¤‘ìš”ì„±</h2>
            <p class="text-[#111418] text-base font-normal leading-normal pb-3 pt-1 px-4 text-center">
              ì¸ì§€ ë¬¸ì œì˜ ì¡°ê¸° ë°œê²¬ê³¼ ì¹˜ë£ŒëŠ” ì§„í–‰ì„ ëŠ¦ì¶”ê³  ì‚¶ì˜ ì§ˆì„ ê°œì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì •ê¸°ì ì¸ í‰ê°€ì™€ ì ê·¹ì ì¸ ê´€ë¦¬ê°€ ì¸ì§€ ì›°ë¹™ì„ ìœ ì§€í•˜ëŠ” í•µì‹¬ì…ë‹ˆë‹¤. ì£¼ì €í•˜ì§€ ë§ˆì‹œê³  ì „ë¬¸ê°€ì˜ ì¡°ì–¸ê³¼ ì§€ì›ì„ ë°›ì•„ë³´ì„¸ìš”.
            </p>
          </div>
        </div>
      </div>
    </div>

<script>
      const $ = (sel) => document.querySelector(sel);
      let map;
      let markers = [];

      // ìƒíƒœ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
      function updateStatus(message, isError = false) {
        const statusEl = $("#status");
        statusEl.innerHTML = `<p class="text-sm ${isError ? 'text-red-700' : 'text-blue-700'}">${message}</p>`;
        if (isError) {
          statusEl.className = "mx-4 mb-3 p-3 rounded-lg bg-red-50 border border-red-200";
        }
      }

      // ì§€ë„ SDK ë¡œë“œ í™•ì¸
      function ensureNaverLoaded() {
        if (typeof naver === "undefined" || !naver.maps) {
          console.error("[NAVER] maps.jsê°€ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");
          updateStatus("ì§€ë„ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ë„¤ì´ë²„ ì§€ë„ API ì„¤ì •ì„ í™•ì¸í•´ ì£¼ì„¸ìš”.", true);
          return false;
        }
        return true;
      }

      // í´ë°± ì¢Œí‘œ(ì„œìš¸ì‹œì²­)
      const DEFAULT_CENTER = { lat: 37.5665, lng: 126.9780 };

      // ìƒ˜í”Œ ì¹˜ë§¤ì•ˆì‹¬ì„¼í„° ë°ì´í„° (API í˜¸ì¶œ ì‹¤íŒ¨ì‹œ ì‚¬ìš©)
      const SAMPLE_CENTERS = [
        {
          title: "ì¢…ë¡œêµ¬ ì¹˜ë§¤ì•ˆì‹¬ì„¼í„°",
          address: "ì„œìš¸íŠ¹ë³„ì‹œ ì¢…ë¡œêµ¬ ì¢…ë¡œ1ê¸¸ 36",
          telephone: "02-2148-3395",
          lat: 37.5735,
          lng: 126.9788
        },
        {
          title: "ì¤‘êµ¬ ì¹˜ë§¤ì•ˆì‹¬ì„¼í„°", 
          address: "ì„œìš¸íŠ¹ë³„ì‹œ ì¤‘êµ¬ ë‹¤ì‚°ë¡œ 120",
          telephone: "02-2263-2844",
          lat: 37.5641,
          lng: 126.9979
        },
        {
          title: "ìš©ì‚°êµ¬ ì¹˜ë§¤ì•ˆì‹¬ì„¼í„°",
          address: "ì„œìš¸íŠ¹ë³„ì‹œ ìš©ì‚°êµ¬ ë…¹ì‚¬í‰ëŒ€ë¡œ 150",
          telephone: "02-2199-8163",
          lat: 37.5386,
          lng: 126.9756
        },
        {
          title: "ì„±ë™êµ¬ ì¹˜ë§¤ì•ˆì‹¬ì„¼í„°",
          address: "ì„œìš¸íŠ¹ë³„ì‹œ ì„±ë™êµ¬ ê³ ì‚°ìë¡œ 270",
          telephone: "02-2286-7062",
          lat: 37.5509,
          lng: 127.0411
        },
        {
          title: "ê´‘ì§„êµ¬ ì¹˜ë§¤ì•ˆì‹¬ì„¼í„°",
          address: "ì„œìš¸íŠ¹ë³„ì‹œ ê´‘ì§„êµ¬ ìì–‘ë¡œ 117",
          telephone: "02-450-1650",
          lat: 37.5388,
          lng: 127.0844
        }
      ];

      // ê³µí†µ ì´ˆê¸°í™”
      function initMapAt(lat, lng, isFallback) {
        if (!ensureNaverLoaded()) return;

        try {
          updateStatus(isFallback ? "ê¸°ë³¸ ìœ„ì¹˜ë¡œ ì§€ë„ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤." : "í˜„ì¬ ìœ„ì¹˜ë¡œ ì§€ë„ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.");

          const center = new naver.maps.LatLng(lat, lng);
          map = new naver.maps.Map('map', { 
            center, 
            zoom: 14,
            mapTypeControl: true
          });

          // í˜„ì¬ ìœ„ì¹˜ ë§ˆì»¤
          new naver.maps.Marker({
            position: center,
            map,
            title: isFallback ? "ê¸°ë³¸ ìœ„ì¹˜(ì„œìš¸ì‹œì²­)" : "í˜„ì¬ ìœ„ì¹˜",
            icon: {
              content: '<div style="background: #ff4444; width: 12px; height: 12px; border-radius: 50%; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3);"></div>',
              anchor: new naver.maps.Point(6, 6)
            }
          });

          if (isFallback) {
            const listEl = $("#center-list");
            const tip = document.createElement("div");
            tip.className = "text-sm text-[#60758a] mb-2";
            tip.textContent = "í˜„ì¬ ìœ„ì¹˜ ì‚¬ìš©ì´ ê±°ë¶€ë˜ì–´ ê¸°ë³¸ ìœ„ì¹˜(ì„œìš¸ì‹œì²­)ë¡œ ì•ˆë‚´ ì¤‘ì…ë‹ˆë‹¤.";
            listEl.prepend(tip);
          }

          // ì„¼í„° ë°ì´í„° ë¡œë”© ì‹œì‘
          loadNearbyCenters(lat, lng);

        } catch (error) {
          console.error("ì§€ë„ ì´ˆê¸°í™” ì˜¤ë¥˜:", error);
          updateStatus("ì§€ë„ ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.", true);
        }
      }

      // í˜„ì¬ ìœ„ì¹˜ ê¸°ë°˜(ì‹¤íŒ¨ ì‹œ í´ë°±)
      function initMapWithMyLocation() {
        if (!navigator.geolocation) {
          console.warn("ì§€ì˜¤ë¡œì¼€ì´ì…˜ ë¯¸ì§€ì› â†’ í´ë°±");
          initMapAt(DEFAULT_CENTER.lat, DEFAULT_CENTER.lng, true);
          return;
        }

        updateStatus("í˜„ì¬ ìœ„ì¹˜ë¥¼ í™•ì¸í•˜ëŠ” ì¤‘ì…ë‹ˆë‹¤...");

        navigator.geolocation.getCurrentPosition(
          (pos) => {
            const lat = pos.coords.latitude;
            const lng = pos.coords.longitude;
            initMapAt(lat, lng, false);
          },
          (err) => {
            console.error("geolocation error:", err);
            initMapAt(DEFAULT_CENTER.lat, DEFAULT_CENTER.lng, true);
          },
          { enableHighAccuracy: true, timeout: 10000, maximumAge: 300000 }
        );
      }

      function clearMarkers() {
        markers.forEach(marker => marker.setMap(null));
        markers = [];
      }

      function renderCenters(items, userLat, userLng) {
        if (!map) return;

        clearMarkers();
        const listEl = $("#center-list");
        listEl.innerHTML = "";

        if (items.length === 0) {
          listEl.innerHTML = '<div class="text-center text-gray-500 py-4">ì£¼ë³€ì— ì¹˜ë§¤ì•ˆì‹¬ì„¼í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</div>';
          return;
        }

        updateStatus(`${items.length}ê°œì˜ ì¹˜ë§¤ì•ˆì‹¬ì„¼í„°ë¥¼ ì°¾ì•˜ìŠµë‹ˆë‹¤.`);

        items.forEach((it, index) => {
          try {
            const latlng = new naver.maps.LatLng(it.lat, it.lng);
            const marker = new naver.maps.Marker({ 
              position: latlng, 
              map,
              title: it.title,
              icon: {
                content: `<div style="background: #0066cc; color: white; padding: 4px 8px; border-radius: 12px; font-size: 12px; font-weight: bold; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3);">${index + 1}</div>`,
                anchor: new naver.maps.Point(15, 15)
              }
            });
            
            markers.push(marker);
            
            const info = new naver.maps.InfoWindow({
              content: `
                <div style="padding: 12px; max-width: 280px; line-height: 1.4;">
                  <div style="font-weight: 700; margin-bottom: 6px; color: #333;">${it.title}</div>
                  <div style="font-size: 13px; color: #666; margin-bottom: 4px;">${it.roadAddress || it.address || ""}</div>
                  <div style="font-size: 13px; color: #666; margin-bottom: 6px;">${it.telephone || ""}</div>
                  <div style="font-size: 12px; color: #0066cc; font-weight: 600;">ê±°ë¦¬: ${it.distance_km.toFixed(1)} km</div>
                </div>`
            });
            
            naver.maps.Event.addListener(marker, "click", () => {
              info.open(map, marker);
            });

            const card = document.createElement("div");
            card.className = "rounded-lg border border-[#dbe0e6] p-4 hover:bg-gray-50 cursor-pointer transition-colors";
            card.innerHTML = `
              <div class="flex items-start gap-3">
                <div class="bg-[#0066cc] text-white rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold flex-shrink-0">${index + 1}</div>
                <div class="flex-1">
                  <div class="text-base font-bold text-[#111418] mb-1">${it.title}</div>
                  <div class="text-sm text-[#60758a] mb-1">${it.roadAddress || it.address || ""}</div>
                  <div class="text-sm text-[#60758a] mb-2">${it.telephone || ""}</div>
                  <div class="text-xs text-[#0066cc] font-semibold">ì•½ ${it.distance_km.toFixed(1)} km</div>
                </div>
              </div>
            `;
            
            card.addEventListener('click', () => {
              map.setCenter(latlng);
              map.setZoom(16);
              info.open(map, marker);
            });
            
            listEl.appendChild(card);
          } catch (error) {
            console.error("ì„¼í„° ë Œë”ë§ ì˜¤ë¥˜:", error, it);
          }
        });
      }

      // ë‘ ì§€ì  ì‚¬ì´ì˜ ê±°ë¦¬ë¥¼ ê³„ì‚°í•˜ëŠ” Haversine ê³µì‹
      function haversine_km(lat1, lon1, lat2, lon2) {
        const R = 6371;
        const dLat = (lat2 - lat1) * Math.PI / 180;
        const dLon = (lon2 - lon1) * Math.PI / 180;
        const a = Math.sin(dLat/2) * Math.sin(dLat/2) +
                  Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
                  Math.sin(dLon/2) * Math.sin(dLon/2);
        const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
        return R * c;
      }

      async function loadNearbyCenters(lat, lng) {
        updateStatus("ì¹˜ë§¤ì•ˆì‹¬ì„¼í„° ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...");
        
        try {
          // ë¨¼ì € ìƒ˜í”Œ ë°ì´í„°ë¡œ ê±°ë¦¬ ê³„ì‚°í•´ì„œ ë³´ì—¬ì£¼ê¸°
          const sampleWithDistance = SAMPLE_CENTERS.map(center => ({
            ...center,
            distance_km: haversine_km(lat, lng, center.lat, center.lng)
          })).sort((a, b) => a.distance_km - b.distance_km);

          renderCenters(sampleWithDistance, lat, lng);

          // ì‹¤ì œ API í˜¸ì¶œ ì‹œë„ (ì‹¤íŒ¨í•´ë„ ìƒ˜í”Œ ë°ì´í„°ëŠ” ìœ ì§€)
          try {
            const serviceKey = 'rOsGTN3QAVdhOCg8qpAg9Phh8MZLgO7JZZQrTqNGdG0fsnUG9%2F2VNTVGVWaRcfdbAxngGnHsL96IOEbNI48VRg%3D%3D';
            const endpoint = '15138421/v1/uddi:8008b803-2419-4066-a3bb-8449371f3cff';
            
            // ì—¬ëŸ¬ í”„ë¡ì‹œ ì‹œë„
            const proxies = [
              'https://api.codetabs.com/v1/proxy?quest=',
              'https://api.allorigins.win/get?url=',
              'https://corsproxy.io/?'
            ];
            
            const apiUrl = `http://api.odcloud.kr/api/${endpoint}?serviceKey=${serviceKey}&page=1&perPage=1000`;
            
            let data = null;
            for (const proxy of proxies) {
              try {
                const url = `${proxy}${encodeURIComponent(apiUrl)}`;
                const r = await fetch(url, { timeout: 5000 });
                
                if (r.ok) {
                  const rawData = await r.json();
                  if (proxy.includes('allorigins')) {
                    data = JSON.parse(rawData.contents);
                  } else {
                    data = rawData;
                  }
                  break;
                }
              } catch (e) {
                console.warn(`Proxy ${proxy} ì‹¤íŒ¨:`, e);
                continue;
              }
            }

            if (data && data.data && data.data.length > 0) {
              const allCenters = data.data.map(center => {
                const latValue = parseFloat(center.ìœ„ë„);
                const lngValue = parseFloat(center.ê²½ë„);
                
                if (isNaN(latValue) || isNaN(lngValue)) {
                  return null;
                }
                
                const dist = haversine_km(lat, lng, latValue, lngValue);
                return {
                  title: center.ì¹˜ë§¤ì•ˆì‹¬ì„¼í„°ëª…,
                  address: center.ì£¼ì†Œ1,
                  roadAddress: center.ì£¼ì†Œ1,
                  telephone: center.ì „í™”ë²ˆí˜¸,
                  lat: latValue,
                  lng: lngValue,
                  distance_km: dist
                };
              }).filter(center => center !== null)
                .sort((a, b) => a.distance_km - b.distance_km);

              if (allCenters.length > 0) {
                renderCenters(allCenters.slice(0, 20), lat, lng);
                updateStatus(`ì‹¤ì œ ë°ì´í„°ë¡œ ${Math.min(allCenters.length, 20)}ê°œ ì„¼í„°ë¥¼ í‘œì‹œí–ˆìŠµë‹ˆë‹¤.`);
              }
            } else {
              updateStatus("APIì—ì„œ ë°ì´í„°ë¥¼ ë°›ì§€ ëª»í•´ ìƒ˜í”Œ ë°ì´í„°ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.");
            }

          } catch (apiError) {
            console.warn("API í˜¸ì¶œ ì‹¤íŒ¨, ìƒ˜í”Œ ë°ì´í„° ì‚¬ìš©:", apiError);
            updateStatus("API ì—°ê²°ì— ì‹¤íŒ¨í–ˆì§€ë§Œ ìƒ˜í”Œ ë°ì´í„°ë¡œ ì„¼í„° ì •ë³´ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.");
          }

        } catch (error) {
          console.error("ì„¼í„° ë¡œë”© ì „ì²´ ì‹¤íŒ¨:", error);
          updateStatus("ì„¼í„° ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.", true);
        }
      }
      
      // DOM ë¡œë“œ ì™„ë£Œ í›„ ì‹œì‘
      document.addEventListener('DOMContentLoaded', function() {
        // ë„¤ì´ë²„ ì§€ë„ SDK ë¡œë“œ ëŒ€ê¸°
        const checkNaverMaps = () => {
          if (typeof naver !== 'undefined' && naver.maps) {
            initMapWithMyLocation();
          } else {
            setTimeout(checkNaverMaps, 100);
          }
        };
        checkNaverMaps();
      });
</script>

</body>
</html>